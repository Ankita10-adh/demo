{% load static %}

{% block body %}

{% include 'admin_naviagtion.html' %}

<style>
    /* Inherit Admin theme colors */
    :root {
        --admin-primary: #1e3c72; /* Deep Blue */
        --admin-secondary: #4a69bd; /* Lighter Blue */
        --admin-bg: #f4f7fa;
        --admin-text: #34495e;
    }

    /* Card container for the form */
    .password-card {
        background-color: #ffffff;
        border-radius: 12px;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        padding: 40px;
        max-width: 500px; /* Constrain width for better focus */
        margin: 50px auto;
        border-top: 5px solid var(--admin-primary); /* Accent line */
    }

    /* Form control styling */
    .form-control {
        border-radius: 8px;
        padding: 10px;
        border: 1px solid #ced4da;
        font-size: 1rem;
        margin-bottom: 15px;
    }

    .form-label {
        font-weight: 600;
        color: var(--admin-text);
        margin-bottom: 5px;
    }

    /* Submit Button Styling */
    .btn-submit {
        background-color: var(--admin-primary);
        border: none;
        color: white;
        font-weight: 600;
        padding: 10px 20px;
        border-radius: 8px;
        transition: all 0.3s ease;
        width: 100%;
        margin-top: 15px;
    }

    .btn-submit:hover {
        background-color: var(--admin-secondary);
        transform: translateY(-1px);
    }
</style>

<script>
    function checkPass() {
        const newPassword = document.changepassword.newpassword.value;
        const confirmPassword = document.changepassword.confirmpassword.value;

        if (newPassword !== confirmPassword) {
            alert('Error: New Password and Confirm Password fields must match.');
            document.changepassword.confirmpassword.focus();
            return false;
        }
        return true; 
    }
</script>

<div class="container">
    <div class="password-card">
        <h3 class="mb-4 text-center text-primary fw-bold">
            <i class="fa-solid fa-lock-open me-2"></i> Administrator Password Change
        </h3>
        
        <form method="post" name="changepassword" onsubmit="return checkPass()">
            {% csrf_token %}
            
            <div class="mb-3">
                <label for="currentpassword" class="form-label">Current Password</label>
                <input type="password" class="form-control" id="currentpassword" name="currentpassword" required>
            </div>

            <div class="mb-3">
                <label for="newpassword" class="form-label">New Password</label>
                <input type="password" class="form-control" id="newpassword" name="newpassword" required>
            </div>

            <div class="mb-4">
                <label for="confirmpassword" class="form-label">Confirm New Password</label>
                <input type="password" class="form-control" id="confirmpassword" name="confirmpassword" required>
            </div>

            <button type="submit" class="btn btn-submit">
                <i class="fa-solid fa-cloud-arrow-up me-2"></i> Commit Changes
            </button>
        </form>
    </div>
</div>

---

## ðŸ”” Backend Messages (Alerts)

This section contains the updated JavaScript blocks for displaying feedback based on the backend response.

{% if error == "No" %}
<script>
    // Success: Logs out the user after a successful change for security.
    alert("Success: The administrator password was changed successfully! You will now be logged out.");
    window.location = "{% url 'Logout' %}";
</script>
{% endif %}

{% if error == "yes" %}
<script>
    // General failure
    alert("System Error: Something went wrong during the update process. Please check logs or try again.");
</script>
{% endif %}

{% if error == "Not" %}
<script>
    // Authentication failure
    alert("Authentication Error: The current password you entered is incorrect. Please verify and try again.");
</script>
{% endif %}


{% endblock %}